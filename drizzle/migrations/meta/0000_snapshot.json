{
  "id": "00000000-0000-0000-0000-000000000000",
  "prevId": "",
  "version": "7",
  "dialect": "postgresql",
  "tables": {
    "public.user_tenants": {
      "name": "user_tenants",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "role": {
          "name": "role",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": true,
          "default": "'user'"
        },
        "can_view_chats": {
          "name": "can_view_chats",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "can_view_recordings": {
          "name": "can_view_recordings",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "can_view_voicemails": {
          "name": "can_view_voicemails",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "can_view_faxes": {
          "name": "can_view_faxes",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "can_view_meetings": {
          "name": "can_view_meetings",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "invited_by": {
          "name": "invited_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "idx_user_tenants_tenant": {
          "name": "idx_user_tenants_tenant",
          "columns": [
            {
              "expression": "tenant_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_user_tenants_user": {
          "name": "idx_user_tenants_user",
          "columns": [
            {
              "expression": "user_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "user_tenants_invited_by_fkey": {
          "name": "user_tenants_invited_by_fkey",
          "tableFrom": "user_tenants",
          "tableTo": "users",
          "schemaTo": "auth",
          "columnsFrom": [
            "invited_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "user_tenants_tenant_id_fkey": {
          "name": "user_tenants_tenant_id_fkey",
          "tableFrom": "user_tenants",
          "tableTo": "tenants",
          "schemaTo": "public",
          "columnsFrom": [
            "tenant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "user_tenants_user_id_fkey": {
          "name": "user_tenants_user_id_fkey",
          "tableFrom": "user_tenants",
          "tableTo": "user_profiles",
          "schemaTo": "public",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "user_tenants_user_id_tenant_id_key": {
          "columns": [
            "user_id",
            "tenant_id"
          ],
          "nullsNotDistinct": false,
          "name": "user_tenants_user_id_tenant_id_key"
        }
      },
      "checkConstraints": {
        "user_tenants_role_check": {
          "name": "user_tenants_role_check",
          "value": "(role)::text = ANY ((ARRAY['admin'::character varying, 'user'::character varying])::text[])"
        }
      },
      "policies": {
        "Super admins can manage all user_tenants": {
          "name": "Super admins can manage all user_tenants",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "authenticated"
          ],
          "withCheck": "is_super_admin()",
          "using": "is_super_admin()"
        },
        "Users can view own tenant associations": {
          "name": "Users can view own tenant associations",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ]
        },
        "Service role full access user_tenants": {
          "name": "Service role full access user_tenants",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.tenant_settings": {
      "name": "tenant_settings",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "key": {
          "name": "key",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": true
        },
        "value": {
          "name": "value",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "tenant_settings_tenant_id_fkey": {
          "name": "tenant_settings_tenant_id_fkey",
          "tableFrom": "tenant_settings",
          "tableTo": "tenants",
          "schemaTo": "public",
          "columnsFrom": [
            "tenant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "tenant_settings_tenant_id_key_key": {
          "columns": [
            "tenant_id",
            "key"
          ],
          "nullsNotDistinct": false,
          "name": "tenant_settings_tenant_id_key_key"
        }
      },
      "checkConstraints": {},
      "policies": {
        "Super admins can manage all tenant settings": {
          "name": "Super admins can manage all tenant settings",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "authenticated"
          ],
          "withCheck": "is_super_admin()",
          "using": "is_super_admin()"
        },
        "Tenant admins can manage their settings": {
          "name": "Tenant admins can manage their settings",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "authenticated"
          ]
        },
        "Service role full access tenant_settings": {
          "name": "Service role full access tenant_settings",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.app_settings": {
      "name": "app_settings",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "key": {
          "name": "key",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": true
        },
        "value": {
          "name": "value",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::jsonb"
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "app_settings_key_key": {
          "columns": [
            "key"
          ],
          "nullsNotDistinct": false,
          "name": "app_settings_key_key"
        }
      },
      "checkConstraints": {},
      "policies": {
        "Super admins can manage app settings": {
          "name": "Super admins can manage app settings",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "authenticated"
          ],
          "withCheck": "is_super_admin()",
          "using": "is_super_admin()"
        },
        "Authenticated users can view app settings": {
          "name": "Authenticated users can view app settings",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ]
        },
        "Service role full access app_settings": {
          "name": "Service role full access app_settings",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.user_profiles": {
      "name": "user_profiles",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true
        },
        "email": {
          "name": "email",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true
        },
        "full_name": {
          "name": "full_name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "avatar_url": {
          "name": "avatar_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "role": {
          "name": "role",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": true,
          "default": "'user'"
        },
        "is_protected": {
          "name": "is_protected",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "last_login_at": {
          "name": "last_login_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "preferences": {
          "name": "preferences",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_user_profiles_email": {
          "name": "idx_user_profiles_email",
          "columns": [
            {
              "expression": "email",
              "asc": true,
              "nulls": "last",
              "opclass": "text_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_user_profiles_role": {
          "name": "idx_user_profiles_role",
          "columns": [
            {
              "expression": "role",
              "asc": true,
              "nulls": "last",
              "opclass": "text_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "user_profiles_id_fkey": {
          "name": "user_profiles_id_fkey",
          "tableFrom": "user_profiles",
          "tableTo": "users",
          "schemaTo": "auth",
          "columnsFrom": [
            "id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {
        "user_profiles_role_check": {
          "name": "user_profiles_role_check",
          "value": "(role)::text = ANY ((ARRAY['super_admin'::character varying, 'admin'::character varying, 'user'::character varying])::text[])"
        }
      },
      "policies": {
        "Users can view own profile": {
          "name": "Users can view own profile",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ],
          "using": "(id = auth.uid())"
        },
        "Users can update own profile": {
          "name": "Users can update own profile",
          "as": "PERMISSIVE",
          "for": "UPDATE",
          "to": [
            "authenticated"
          ]
        },
        "Service role full access user_profiles": {
          "name": "Service role full access user_profiles",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.conversations": {
      "name": "conversations",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "threecx_chat_id": {
          "name": "threecx_chat_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "subject": {
          "name": "subject",
          "type": "varchar(500)",
          "primaryKey": false,
          "notNull": false
        },
        "channel_type": {
          "name": "channel_type",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false,
          "default": "'chat'"
        },
        "is_group": {
          "name": "is_group",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "status": {
          "name": "status",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false,
          "default": "'active'"
        },
        "message_count": {
          "name": "message_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "last_message_at": {
          "name": "last_message_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_conversations_last_message": {
          "name": "idx_conversations_last_message",
          "columns": [
            {
              "expression": "last_message_at",
              "asc": false,
              "nulls": "first",
              "opclass": "timestamptz_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_conversations_tenant": {
          "name": "idx_conversations_tenant",
          "columns": [
            {
              "expression": "tenant_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_conversations_threecx_id": {
          "name": "idx_conversations_threecx_id",
          "columns": [
            {
              "expression": "threecx_chat_id",
              "asc": true,
              "nulls": "last",
              "opclass": "text_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "conversations_tenant_id_fkey": {
          "name": "conversations_tenant_id_fkey",
          "tableFrom": "conversations",
          "tableTo": "tenants",
          "schemaTo": "public",
          "columnsFrom": [
            "tenant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "conversations_tenant_id_threecx_chat_id_key": {
          "columns": [
            "tenant_id",
            "threecx_chat_id"
          ],
          "nullsNotDistinct": false,
          "name": "conversations_tenant_id_threecx_chat_id_key"
        }
      },
      "checkConstraints": {},
      "policies": {
        "Users can view tenant conversations": {
          "name": "Users can view tenant conversations",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ],
          "using": "(tenant_id IN ( SELECT get_user_tenant_ids() AS get_user_tenant_ids))"
        },
        "Service role full access conversations": {
          "name": "Service role full access conversations",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.participants": {
      "name": "participants",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "conversation_id": {
          "name": "conversation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "extension_id": {
          "name": "extension_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "participant_type": {
          "name": "participant_type",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false,
          "default": "'internal'"
        },
        "external_id": {
          "name": "external_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "external_name": {
          "name": "external_name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "external_number": {
          "name": "external_number",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "joined_at": {
          "name": "joined_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "left_at": {
          "name": "left_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        }
      },
      "indexes": {
        "idx_participants_conversation": {
          "name": "idx_participants_conversation",
          "columns": [
            {
              "expression": "conversation_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_participants_extension": {
          "name": "idx_participants_extension",
          "columns": [
            {
              "expression": "extension_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "participants_conversation_id_fkey": {
          "name": "participants_conversation_id_fkey",
          "tableFrom": "participants",
          "tableTo": "conversations",
          "schemaTo": "public",
          "columnsFrom": [
            "conversation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "participants_extension_id_fkey": {
          "name": "participants_extension_id_fkey",
          "tableFrom": "participants",
          "tableTo": "extensions",
          "schemaTo": "public",
          "columnsFrom": [
            "extension_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {},
      "policies": {
        "Users can view tenant participants": {
          "name": "Users can view tenant participants",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ],
          "using": "(conversation_id IN ( SELECT conversations.id\n   FROM conversations\n  WHERE (conversations.tenant_id IN ( SELECT get_user_tenant_ids() AS get_user_tenant_ids))))"
        },
        "Service role full access participants": {
          "name": "Service role full access participants",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.messages": {
      "name": "messages",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "conversation_id": {
          "name": "conversation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "sender_participant_id": {
          "name": "sender_participant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "threecx_message_id": {
          "name": "threecx_message_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "content": {
          "name": "content",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "message_type": {
          "name": "message_type",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false,
          "default": "'text'"
        },
        "is_from_external": {
          "name": "is_from_external",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "sent_at": {
          "name": "sent_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true
        },
        "delivered_at": {
          "name": "delivered_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "read_at": {
          "name": "read_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_messages_conversation": {
          "name": "idx_messages_conversation",
          "columns": [
            {
              "expression": "conversation_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_messages_sent_at": {
          "name": "idx_messages_sent_at",
          "columns": [
            {
              "expression": "sent_at",
              "asc": false,
              "nulls": "first",
              "opclass": "timestamptz_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_messages_tenant": {
          "name": "idx_messages_tenant",
          "columns": [
            {
              "expression": "tenant_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_messages_threecx_id": {
          "name": "idx_messages_threecx_id",
          "columns": [
            {
              "expression": "threecx_message_id",
              "asc": true,
              "nulls": "last",
              "opclass": "text_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "messages_conversation_id_fkey": {
          "name": "messages_conversation_id_fkey",
          "tableFrom": "messages",
          "tableTo": "conversations",
          "schemaTo": "public",
          "columnsFrom": [
            "conversation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "messages_sender_participant_id_fkey": {
          "name": "messages_sender_participant_id_fkey",
          "tableFrom": "messages",
          "tableTo": "participants",
          "schemaTo": "public",
          "columnsFrom": [
            "sender_participant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "messages_tenant_id_fkey": {
          "name": "messages_tenant_id_fkey",
          "tableFrom": "messages",
          "tableTo": "tenants",
          "schemaTo": "public",
          "columnsFrom": [
            "tenant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {},
      "policies": {
        "Users can view tenant messages": {
          "name": "Users can view tenant messages",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ],
          "using": "(tenant_id IN ( SELECT get_user_tenant_ids() AS get_user_tenant_ids))"
        },
        "Service role full access messages": {
          "name": "Service role full access messages",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.media_files": {
      "name": "media_files",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "message_id": {
          "name": "message_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "file_name": {
          "name": "file_name",
          "type": "varchar(500)",
          "primaryKey": false,
          "notNull": true
        },
        "file_type": {
          "name": "file_type",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false
        },
        "file_size": {
          "name": "file_size",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false
        },
        "mime_type": {
          "name": "mime_type",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false
        },
        "storage_path": {
          "name": "storage_path",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "thumbnail_path": {
          "name": "thumbnail_path",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "duration_seconds": {
          "name": "duration_seconds",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_media_files_message": {
          "name": "idx_media_files_message",
          "columns": [
            {
              "expression": "message_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_media_files_tenant": {
          "name": "idx_media_files_tenant",
          "columns": [
            {
              "expression": "tenant_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "media_files_message_id_fkey": {
          "name": "media_files_message_id_fkey",
          "tableFrom": "media_files",
          "tableTo": "messages",
          "schemaTo": "public",
          "columnsFrom": [
            "message_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "media_files_tenant_id_fkey": {
          "name": "media_files_tenant_id_fkey",
          "tableFrom": "media_files",
          "tableTo": "tenants",
          "schemaTo": "public",
          "columnsFrom": [
            "tenant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {},
      "policies": {
        "Users can view tenant media": {
          "name": "Users can view tenant media",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ],
          "using": "(tenant_id IN ( SELECT get_user_tenant_ids() AS get_user_tenant_ids))"
        },
        "Service role full access media_files": {
          "name": "Service role full access media_files",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.call_recordings": {
      "name": "call_recordings",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "threecx_call_id": {
          "name": "threecx_call_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "file_name": {
          "name": "file_name",
          "type": "varchar(500)",
          "primaryKey": false,
          "notNull": true
        },
        "file_size": {
          "name": "file_size",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false
        },
        "duration_seconds": {
          "name": "duration_seconds",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "storage_path": {
          "name": "storage_path",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "caller_number": {
          "name": "caller_number",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "caller_name": {
          "name": "caller_name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "callee_number": {
          "name": "callee_number",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "callee_name": {
          "name": "callee_name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "extension_id": {
          "name": "extension_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "direction": {
          "name": "direction",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": false
        },
        "call_type": {
          "name": "call_type",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "started_at": {
          "name": "started_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true
        },
        "ended_at": {
          "name": "ended_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_call_recordings_extension": {
          "name": "idx_call_recordings_extension",
          "columns": [
            {
              "expression": "extension_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_call_recordings_started": {
          "name": "idx_call_recordings_started",
          "columns": [
            {
              "expression": "started_at",
              "asc": false,
              "nulls": "first",
              "opclass": "timestamptz_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_call_recordings_tenant": {
          "name": "idx_call_recordings_tenant",
          "columns": [
            {
              "expression": "tenant_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "call_recordings_extension_id_fkey": {
          "name": "call_recordings_extension_id_fkey",
          "tableFrom": "call_recordings",
          "tableTo": "extensions",
          "schemaTo": "public",
          "columnsFrom": [
            "extension_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "call_recordings_tenant_id_fkey": {
          "name": "call_recordings_tenant_id_fkey",
          "tableFrom": "call_recordings",
          "tableTo": "tenants",
          "schemaTo": "public",
          "columnsFrom": [
            "tenant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "call_recordings_tenant_id_threecx_call_id_key": {
          "columns": [
            "tenant_id",
            "threecx_call_id"
          ],
          "nullsNotDistinct": false,
          "name": "call_recordings_tenant_id_threecx_call_id_key"
        }
      },
      "checkConstraints": {},
      "policies": {
        "Users can view tenant recordings": {
          "name": "Users can view tenant recordings",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ],
          "using": "(tenant_id IN ( SELECT get_user_tenant_ids() AS get_user_tenant_ids))"
        },
        "Service role full access call_recordings": {
          "name": "Service role full access call_recordings",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.voicemails": {
      "name": "voicemails",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "threecx_voicemail_id": {
          "name": "threecx_voicemail_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "extension_id": {
          "name": "extension_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "file_name": {
          "name": "file_name",
          "type": "varchar(500)",
          "primaryKey": false,
          "notNull": true
        },
        "file_size": {
          "name": "file_size",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false
        },
        "duration_seconds": {
          "name": "duration_seconds",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "storage_path": {
          "name": "storage_path",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "caller_number": {
          "name": "caller_number",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "caller_name": {
          "name": "caller_name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "transcription": {
          "name": "transcription",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "is_read": {
          "name": "is_read",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "received_at": {
          "name": "received_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_voicemails_extension": {
          "name": "idx_voicemails_extension",
          "columns": [
            {
              "expression": "extension_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_voicemails_received": {
          "name": "idx_voicemails_received",
          "columns": [
            {
              "expression": "received_at",
              "asc": false,
              "nulls": "first",
              "opclass": "timestamptz_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_voicemails_tenant": {
          "name": "idx_voicemails_tenant",
          "columns": [
            {
              "expression": "tenant_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "voicemails_extension_id_fkey": {
          "name": "voicemails_extension_id_fkey",
          "tableFrom": "voicemails",
          "tableTo": "extensions",
          "schemaTo": "public",
          "columnsFrom": [
            "extension_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "voicemails_tenant_id_fkey": {
          "name": "voicemails_tenant_id_fkey",
          "tableFrom": "voicemails",
          "tableTo": "tenants",
          "schemaTo": "public",
          "columnsFrom": [
            "tenant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "voicemails_tenant_id_threecx_voicemail_id_key": {
          "columns": [
            "tenant_id",
            "threecx_voicemail_id"
          ],
          "nullsNotDistinct": false,
          "name": "voicemails_tenant_id_threecx_voicemail_id_key"
        }
      },
      "checkConstraints": {},
      "policies": {
        "Users can view tenant voicemails": {
          "name": "Users can view tenant voicemails",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ],
          "using": "(tenant_id IN ( SELECT get_user_tenant_ids() AS get_user_tenant_ids))"
        },
        "Service role full access voicemails": {
          "name": "Service role full access voicemails",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.faxes": {
      "name": "faxes",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "threecx_fax_id": {
          "name": "threecx_fax_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "extension_id": {
          "name": "extension_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "file_name": {
          "name": "file_name",
          "type": "varchar(500)",
          "primaryKey": false,
          "notNull": true
        },
        "file_size": {
          "name": "file_size",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false
        },
        "page_count": {
          "name": "page_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "storage_path": {
          "name": "storage_path",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "direction": {
          "name": "direction",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": false
        },
        "remote_number": {
          "name": "remote_number",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "remote_name": {
          "name": "remote_name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "sent_received_at": {
          "name": "sent_received_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_faxes_date": {
          "name": "idx_faxes_date",
          "columns": [
            {
              "expression": "sent_received_at",
              "asc": false,
              "nulls": "first",
              "opclass": "timestamptz_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_faxes_extension": {
          "name": "idx_faxes_extension",
          "columns": [
            {
              "expression": "extension_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_faxes_tenant": {
          "name": "idx_faxes_tenant",
          "columns": [
            {
              "expression": "tenant_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "faxes_extension_id_fkey": {
          "name": "faxes_extension_id_fkey",
          "tableFrom": "faxes",
          "tableTo": "extensions",
          "schemaTo": "public",
          "columnsFrom": [
            "extension_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "faxes_tenant_id_fkey": {
          "name": "faxes_tenant_id_fkey",
          "tableFrom": "faxes",
          "tableTo": "tenants",
          "schemaTo": "public",
          "columnsFrom": [
            "tenant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "faxes_tenant_id_threecx_fax_id_key": {
          "columns": [
            "tenant_id",
            "threecx_fax_id"
          ],
          "nullsNotDistinct": false,
          "name": "faxes_tenant_id_threecx_fax_id_key"
        }
      },
      "checkConstraints": {},
      "policies": {
        "Users can view tenant faxes": {
          "name": "Users can view tenant faxes",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ],
          "using": "(tenant_id IN ( SELECT get_user_tenant_ids() AS get_user_tenant_ids))"
        },
        "Service role full access faxes": {
          "name": "Service role full access faxes",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.call_logs": {
      "name": "call_logs",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "threecx_call_id": {
          "name": "threecx_call_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "extension_id": {
          "name": "extension_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "caller_number": {
          "name": "caller_number",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "caller_name": {
          "name": "caller_name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "callee_number": {
          "name": "callee_number",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "callee_name": {
          "name": "callee_name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "direction": {
          "name": "direction",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": false
        },
        "call_type": {
          "name": "call_type",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "duration_seconds": {
          "name": "duration_seconds",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "ring_duration_seconds": {
          "name": "ring_duration_seconds",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "queue_wait_seconds": {
          "name": "queue_wait_seconds",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "started_at": {
          "name": "started_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true
        },
        "answered_at": {
          "name": "answered_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "ended_at": {
          "name": "ended_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "recording_id": {
          "name": "recording_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_call_logs_extension": {
          "name": "idx_call_logs_extension",
          "columns": [
            {
              "expression": "extension_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_call_logs_started": {
          "name": "idx_call_logs_started",
          "columns": [
            {
              "expression": "started_at",
              "asc": false,
              "nulls": "first",
              "opclass": "timestamptz_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_call_logs_tenant": {
          "name": "idx_call_logs_tenant",
          "columns": [
            {
              "expression": "tenant_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "call_logs_extension_id_fkey": {
          "name": "call_logs_extension_id_fkey",
          "tableFrom": "call_logs",
          "tableTo": "extensions",
          "schemaTo": "public",
          "columnsFrom": [
            "extension_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "call_logs_recording_id_fkey": {
          "name": "call_logs_recording_id_fkey",
          "tableFrom": "call_logs",
          "tableTo": "call_recordings",
          "schemaTo": "public",
          "columnsFrom": [
            "recording_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "call_logs_tenant_id_fkey": {
          "name": "call_logs_tenant_id_fkey",
          "tableFrom": "call_logs",
          "tableTo": "tenants",
          "schemaTo": "public",
          "columnsFrom": [
            "tenant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "call_logs_tenant_id_threecx_call_id_key": {
          "columns": [
            "tenant_id",
            "threecx_call_id"
          ],
          "nullsNotDistinct": false,
          "name": "call_logs_tenant_id_threecx_call_id_key"
        }
      },
      "checkConstraints": {},
      "policies": {
        "Users can view tenant call logs": {
          "name": "Users can view tenant call logs",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ],
          "using": "(tenant_id IN ( SELECT get_user_tenant_ids() AS get_user_tenant_ids))"
        },
        "Service role full access call_logs": {
          "name": "Service role full access call_logs",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.meeting_recordings": {
      "name": "meeting_recordings",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "threecx_meeting_id": {
          "name": "threecx_meeting_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "title": {
          "name": "title",
          "type": "varchar(500)",
          "primaryKey": false,
          "notNull": false
        },
        "file_name": {
          "name": "file_name",
          "type": "varchar(500)",
          "primaryKey": false,
          "notNull": true
        },
        "file_size": {
          "name": "file_size",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false
        },
        "duration_seconds": {
          "name": "duration_seconds",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "storage_path": {
          "name": "storage_path",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "organizer_extension_id": {
          "name": "organizer_extension_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "organizer_name": {
          "name": "organizer_name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "organizer_email": {
          "name": "organizer_email",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "participant_count": {
          "name": "participant_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "participants": {
          "name": "participants",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::jsonb"
        },
        "started_at": {
          "name": "started_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true
        },
        "ended_at": {
          "name": "ended_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "meeting_type": {
          "name": "meeting_type",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false,
          "default": "'scheduled'"
        },
        "is_recurring": {
          "name": "is_recurring",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_meeting_recordings_organizer": {
          "name": "idx_meeting_recordings_organizer",
          "columns": [
            {
              "expression": "organizer_extension_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_meeting_recordings_started": {
          "name": "idx_meeting_recordings_started",
          "columns": [
            {
              "expression": "started_at",
              "asc": false,
              "nulls": "first",
              "opclass": "timestamptz_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_meeting_recordings_tenant": {
          "name": "idx_meeting_recordings_tenant",
          "columns": [
            {
              "expression": "tenant_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "meeting_recordings_organizer_extension_id_fkey": {
          "name": "meeting_recordings_organizer_extension_id_fkey",
          "tableFrom": "meeting_recordings",
          "tableTo": "extensions",
          "schemaTo": "public",
          "columnsFrom": [
            "organizer_extension_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "meeting_recordings_tenant_id_fkey": {
          "name": "meeting_recordings_tenant_id_fkey",
          "tableFrom": "meeting_recordings",
          "tableTo": "tenants",
          "schemaTo": "public",
          "columnsFrom": [
            "tenant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "meeting_recordings_tenant_id_threecx_meeting_id_key": {
          "columns": [
            "tenant_id",
            "threecx_meeting_id"
          ],
          "nullsNotDistinct": false,
          "name": "meeting_recordings_tenant_id_threecx_meeting_id_key"
        }
      },
      "checkConstraints": {},
      "policies": {
        "Users can view tenant meetings": {
          "name": "Users can view tenant meetings",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ],
          "using": "(tenant_id IN ( SELECT get_user_tenant_ids() AS get_user_tenant_ids))"
        },
        "Service role full access meeting_recordings": {
          "name": "Service role full access meeting_recordings",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.extensions": {
      "name": "extensions",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "extension_number": {
          "name": "extension_number",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": true
        },
        "display_name": {
          "name": "display_name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "email": {
          "name": "email",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "department": {
          "name": "department",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_extensions_number": {
          "name": "idx_extensions_number",
          "columns": [
            {
              "expression": "extension_number",
              "asc": true,
              "nulls": "last",
              "opclass": "text_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_extensions_tenant": {
          "name": "idx_extensions_tenant",
          "columns": [
            {
              "expression": "tenant_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "extensions_tenant_id_fkey": {
          "name": "extensions_tenant_id_fkey",
          "tableFrom": "extensions",
          "tableTo": "tenants",
          "schemaTo": "public",
          "columnsFrom": [
            "tenant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "extensions_tenant_id_extension_number_key": {
          "columns": [
            "tenant_id",
            "extension_number"
          ],
          "nullsNotDistinct": false,
          "name": "extensions_tenant_id_extension_number_key"
        }
      },
      "checkConstraints": {},
      "policies": {
        "Users can view tenant extensions": {
          "name": "Users can view tenant extensions",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ],
          "using": "(tenant_id IN ( SELECT get_user_tenant_ids() AS get_user_tenant_ids))"
        },
        "Service role full access extensions": {
          "name": "Service role full access extensions",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.sync_status": {
      "name": "sync_status",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "sync_type": {
          "name": "sync_type",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": true,
          "default": "'idle'"
        },
        "last_sync_at": {
          "name": "last_sync_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "last_successful_sync_at": {
          "name": "last_successful_sync_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "next_sync_at": {
          "name": "next_sync_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "items_synced": {
          "name": "items_synced",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "items_failed": {
          "name": "items_failed",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_sync_status_tenant": {
          "name": "idx_sync_status_tenant",
          "columns": [
            {
              "expression": "tenant_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_sync_status_type": {
          "name": "idx_sync_status_type",
          "columns": [
            {
              "expression": "sync_type",
              "asc": true,
              "nulls": "last",
              "opclass": "text_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "sync_status_tenant_id_fkey": {
          "name": "sync_status_tenant_id_fkey",
          "tableFrom": "sync_status",
          "tableTo": "tenants",
          "schemaTo": "public",
          "columnsFrom": [
            "tenant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {},
      "policies": {
        "Super admins can manage sync status": {
          "name": "Super admins can manage sync status",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "authenticated"
          ],
          "withCheck": "is_super_admin()",
          "using": "is_super_admin()"
        },
        "Users can view sync status": {
          "name": "Users can view sync status",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ]
        },
        "Service role full access sync_status": {
          "name": "Service role full access sync_status",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.sync_logs": {
      "name": "sync_logs",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "sync_type": {
          "name": "sync_type",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": true
        },
        "started_at": {
          "name": "started_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "completed_at": {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "items_processed": {
          "name": "items_processed",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "items_created": {
          "name": "items_created",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "items_updated": {
          "name": "items_updated",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "items_failed": {
          "name": "items_failed",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "error_details": {
          "name": "error_details",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        }
      },
      "indexes": {
        "idx_sync_logs_started": {
          "name": "idx_sync_logs_started",
          "columns": [
            {
              "expression": "started_at",
              "asc": false,
              "nulls": "first",
              "opclass": "timestamptz_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_sync_logs_tenant": {
          "name": "idx_sync_logs_tenant",
          "columns": [
            {
              "expression": "tenant_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "sync_logs_tenant_id_fkey": {
          "name": "sync_logs_tenant_id_fkey",
          "tableFrom": "sync_logs",
          "tableTo": "tenants",
          "schemaTo": "public",
          "columnsFrom": [
            "tenant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {},
      "policies": {
        "Super admins can manage sync logs": {
          "name": "Super admins can manage sync logs",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "authenticated"
          ],
          "withCheck": "is_super_admin()",
          "using": "is_super_admin()"
        },
        "Users can view sync logs": {
          "name": "Users can view sync logs",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ]
        },
        "Service role full access sync_logs": {
          "name": "Service role full access sync_logs",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.storage_usage": {
      "name": "storage_usage",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "date": {
          "name": "date",
          "type": "date",
          "primaryKey": false,
          "notNull": true,
          "default": "CURRENT_DATE"
        },
        "chat_media_bytes": {
          "name": "chat_media_bytes",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "recordings_bytes": {
          "name": "recordings_bytes",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "voicemails_bytes": {
          "name": "voicemails_bytes",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "faxes_bytes": {
          "name": "faxes_bytes",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "meetings_bytes": {
          "name": "meetings_bytes",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "total_bytes": {
          "name": "total_bytes",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_storage_usage_tenant_date": {
          "name": "idx_storage_usage_tenant_date",
          "columns": [
            {
              "expression": "tenant_id",
              "asc": true,
              "nulls": "last",
              "opclass": "date_ops",
              "isExpression": false
            },
            {
              "expression": "date",
              "asc": false,
              "nulls": "first",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "storage_usage_tenant_id_fkey": {
          "name": "storage_usage_tenant_id_fkey",
          "tableFrom": "storage_usage",
          "tableTo": "tenants",
          "schemaTo": "public",
          "columnsFrom": [
            "tenant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "storage_usage_tenant_id_date_key": {
          "columns": [
            "tenant_id",
            "date"
          ],
          "nullsNotDistinct": false,
          "name": "storage_usage_tenant_id_date_key"
        }
      },
      "checkConstraints": {},
      "policies": {
        "Users can view storage usage": {
          "name": "Users can view storage usage",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ],
          "using": "(tenant_id IN ( SELECT get_user_tenant_ids() AS get_user_tenant_ids))"
        },
        "Service role full access storage_usage": {
          "name": "Service role full access storage_usage",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.audit_logs": {
      "name": "audit_logs",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "action": {
          "name": "action",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": true
        },
        "entity_type": {
          "name": "entity_type",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "entity_id": {
          "name": "entity_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "old_values": {
          "name": "old_values",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "new_values": {
          "name": "new_values",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "ip_address": {
          "name": "ip_address",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "user_agent": {
          "name": "user_agent",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_audit_logs_created": {
          "name": "idx_audit_logs_created",
          "columns": [
            {
              "expression": "created_at",
              "asc": false,
              "nulls": "first",
              "opclass": "timestamptz_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_audit_logs_tenant": {
          "name": "idx_audit_logs_tenant",
          "columns": [
            {
              "expression": "tenant_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_audit_logs_user": {
          "name": "idx_audit_logs_user",
          "columns": [
            {
              "expression": "user_id",
              "asc": true,
              "nulls": "last",
              "opclass": "uuid_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "audit_logs_tenant_id_fkey": {
          "name": "audit_logs_tenant_id_fkey",
          "tableFrom": "audit_logs",
          "tableTo": "tenants",
          "schemaTo": "public",
          "columnsFrom": [
            "tenant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "audit_logs_user_id_fkey": {
          "name": "audit_logs_user_id_fkey",
          "tableFrom": "audit_logs",
          "tableTo": "users",
          "schemaTo": "auth",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {},
      "policies": {
        "Super admins can view all audit logs": {
          "name": "Super admins can view all audit logs",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ],
          "using": "is_super_admin()"
        },
        "Users can view own audit logs": {
          "name": "Users can view own audit logs",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ]
        },
        "Service role full access audit_logs": {
          "name": "Service role full access audit_logs",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    },
    "public.tenants": {
      "name": "tenants",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "name": {
          "name": "name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true
        },
        "slug": {
          "name": "slug",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": true
        },
        "logo_url": {
          "name": "logo_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "storage_quota_bytes": {
          "name": "storage_quota_bytes",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false,
          "default": "'10737418240'"
        },
        "storage_used_bytes": {
          "name": "storage_used_bytes",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "settings": {
          "name": "settings",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::jsonb"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "threecx_host": {
          "name": "threecx_host",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "threecx_port": {
          "name": "threecx_port",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 5432
        },
        "threecx_database": {
          "name": "threecx_database",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false,
          "default": "'database_single'"
        },
        "threecx_user": {
          "name": "threecx_user",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": false,
          "default": "'postgres'"
        },
        "threecx_password": {
          "name": "threecx_password",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "threecx_chat_files_path": {
          "name": "threecx_chat_files_path",
          "type": "varchar(500)",
          "primaryKey": false,
          "notNull": false,
          "default": "'/var/lib/3cxpbx/Instance1/Data/Http/Files/Chat Files'"
        },
        "threecx_recordings_path": {
          "name": "threecx_recordings_path",
          "type": "varchar(500)",
          "primaryKey": false,
          "notNull": false,
          "default": "'/var/lib/3cxpbx/Instance1/Data/Recordings'"
        },
        "threecx_voicemail_path": {
          "name": "threecx_voicemail_path",
          "type": "varchar(500)",
          "primaryKey": false,
          "notNull": false,
          "default": "'/var/lib/3cxpbx/Instance1/Data/Voicemail'"
        },
        "threecx_fax_path": {
          "name": "threecx_fax_path",
          "type": "varchar(500)",
          "primaryKey": false,
          "notNull": false,
          "default": "'/var/lib/3cxpbx/Instance1/Data/Fax'"
        },
        "threecx_meetings_path": {
          "name": "threecx_meetings_path",
          "type": "varchar(500)",
          "primaryKey": false,
          "notNull": false,
          "default": "'/var/lib/3cxpbx/Instance1/Data/Http/Recordings'"
        },
        "backup_chats": {
          "name": "backup_chats",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "backup_chat_media": {
          "name": "backup_chat_media",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "backup_recordings": {
          "name": "backup_recordings",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "backup_voicemails": {
          "name": "backup_voicemails",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "backup_faxes": {
          "name": "backup_faxes",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "backup_cdr": {
          "name": "backup_cdr",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "backup_meetings": {
          "name": "backup_meetings",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "sync_enabled": {
          "name": "sync_enabled",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "sync_interval_seconds": {
          "name": "sync_interval_seconds",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 60
        },
        "last_sync_at": {
          "name": "last_sync_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "idx_tenants_active": {
          "name": "idx_tenants_active",
          "columns": [
            {
              "expression": "is_active",
              "asc": true,
              "nulls": "last",
              "opclass": "bool_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_tenants_slug": {
          "name": "idx_tenants_slug",
          "columns": [
            {
              "expression": "slug",
              "asc": true,
              "nulls": "last",
              "opclass": "text_ops",
              "isExpression": false
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "tenants_slug_key": {
          "columns": [
            "slug"
          ],
          "nullsNotDistinct": false,
          "name": "tenants_slug_key"
        }
      },
      "checkConstraints": {},
      "policies": {
        "Super admins can manage all tenants": {
          "name": "Super admins can manage all tenants",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "authenticated"
          ],
          "withCheck": "is_super_admin()",
          "using": "is_super_admin()"
        },
        "Users can view their tenants": {
          "name": "Users can view their tenants",
          "as": "PERMISSIVE",
          "for": "SELECT",
          "to": [
            "authenticated"
          ]
        },
        "Service role full access tenants": {
          "name": "Service role full access tenants",
          "as": "PERMISSIVE",
          "for": "ALL",
          "to": [
            "service_role"
          ]
        }
      },
      "isRLSEnabled": true
    }
  },
  "enums": {},
  "schemas": {},
  "sequences": {},
  "roles": {},
  "policies": {},
  "views": {
    "public.tenant_storage_usage": {
      "name": "tenant_storage_usage",
      "schema": "public",
      "columns": {
        "tenant_id": {
          "name": "tenant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "tenant_name": {
          "name": "tenant_name",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "storage_quota_bytes": {
          "name": "storage_quota_bytes",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false
        },
        "storage_used_bytes": {
          "name": "storage_used_bytes",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false
        },
        "chat_media_bytes": {
          "name": "chat_media_bytes",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        },
        "recordings_bytes": {
          "name": "recordings_bytes",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        },
        "voicemails_bytes": {
          "name": "voicemails_bytes",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        },
        "faxes_bytes": {
          "name": "faxes_bytes",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        },
        "meetings_bytes": {
          "name": "meetings_bytes",
          "type": "numeric",
          "primaryKey": false,
          "notNull": false
        },
        "media_files_count": {
          "name": "media_files_count",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false
        },
        "recordings_count": {
          "name": "recordings_count",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false
        },
        "voicemails_count": {
          "name": "voicemails_count",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false
        },
        "faxes_count": {
          "name": "faxes_count",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false
        },
        "meetings_count": {
          "name": "meetings_count",
          "type": "bigint",
          "primaryKey": false,
          "notNull": false
        }
      },
      "isExisting": false,
      "definition": "SELECT t.id AS tenant_id, t.name AS tenant_name, t.storage_quota_bytes, t.storage_used_bytes, COALESCE(sum(mf.file_size), 0::numeric) AS chat_media_bytes, COALESCE(sum(cr.file_size), 0::numeric) AS recordings_bytes, COALESCE(sum(vm.file_size), 0::numeric) AS voicemails_bytes, COALESCE(sum(fx.file_size), 0::numeric) AS faxes_bytes, COALESCE(sum(mr.file_size), 0::numeric) AS meetings_bytes, count(DISTINCT mf.id) AS media_files_count, count(DISTINCT cr.id) AS recordings_count, count(DISTINCT vm.id) AS voicemails_count, count(DISTINCT fx.id) AS faxes_count, count(DISTINCT mr.id) AS meetings_count FROM tenants t LEFT JOIN media_files mf ON mf.tenant_id = t.id LEFT JOIN call_recordings cr ON cr.tenant_id = t.id LEFT JOIN voicemails vm ON vm.tenant_id = t.id LEFT JOIN faxes fx ON fx.tenant_id = t.id LEFT JOIN meeting_recordings mr ON mr.tenant_id = t.id GROUP BY t.id",
      "materialized": false
    }
  },
  "_meta": {
    "schemas": {},
    "tables": {},
    "columns": {}
  },
  "internal": {
    "tables": {
      "tenants": {
        "columns": {
          "storage_quota_bytes": {
            "isDefaultAnExpression": true
          }
        }
      }
    }
  }
}